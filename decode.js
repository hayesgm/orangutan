var showMessages = function(string) {
  console.log(string);
};

(function() {
  var keys = {
    "bob": {"public":"-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\n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\n=bgLG\n-----END PGP PUBLIC KEY BLOCK-----","private":"-----BEGIN PGP PRIVATE KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\n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\n=wGpx\n-----END PGP PRIVATE KEY BLOCK-----\n"},
    "jones": {"public": "-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\nmQENBFHCsrMBCADTu7MaFTuNKzMxYz0sDtWrAG692rg2z7JJ2KrJRoX62l2OWJQz\nvSP9767+i/SeTQiVnvb53gBWUycXyX7IHneius8Mien7TOdaLqOSvFEKPC0F0Sq0\n2ccoJzwKQUy3VYPb4qoQ0lMg6IAG9oTg1KcCD4lCu2dZhHre8bbjK6DIE9nAl7y4\nBZogeExpRpVoWH/zPQRiP1UsDtgR3yImva/MCKBU3s7Ugeh4qNAxfwuVrHGcEYu8\n0YfMeNPkljHE/Qkg4JEYbZHHeqSruLl/lhQ+R6uLwWDP0lqwrxroMRbYe52Trxud\nDmt8xvESJ5DLvVE/WtU73Ddevt5+0CddjcePABEBAAG0GVRvbSBKb25lcyA8dG9t\nQGpvbmVzLmNvbT6JATcEEwEKACEFAlHCsrMCGwMFCwkIBwMFFQoJCAsFFgIDAQAC\nHgECF4AACgkQn08CGN2Z0nUjSwf7BEbs/Ki98teJct1QEFN0Bs+IIGDLB0wb1gWK\nQdPgj0gw15MKmrYo6I8FnAoRTw+Td3nUvxvO/Cm7Ia7/Q2YKrpkWLqBuXPjdUtbX\niqSFw7UsgmeARiFBJu5iZmH+8ckDY/F0R+CD9fAplD8erBbYyxmQ5EwP0CFF80DH\nmcZPex6XDzzxaLkrrBADG8oeoLQBRXpoWTgzvEn/U0D4x2jpyVIw1G1C9rWsVBfe\nQ/DIDDZWh13SUvPhF3HRBbkAd0BtrAiWxBCF1UCqG2iJvyLlTSVpXxyIHDZpfRe8\nK+oZ3ILyuXb5jQFgXcDhrfCeHM5fHpDZnyFXe1qGwJq48zhWR7kBDQRRwrKzAQgA\nufQhc7DUUm/N6pHjFnI3o65lXABo7bebzKN+hTvE0zaAvMFS1RuJgeynJJyrvTTB\n7/6xMN1KQX3rUBERafLKYclPDHgE/vWgXxiS5A9IfO8eIEP24AAEP2/wliKxs2QM\ndh5Q38PS1OpgcaAel1BwKqeDFrgwfyX1wtC22YrnSxQzhoacBl9W9cmnRTdrLwF9\njKfTRY62DvDs3wB44b5DQn+9bf5zgfoFsevD2r3exsPsKYOx9pz7U3qmWGtsinfc\n7fXgxtn5A9TFKdArkyv3LpsOwrbNgGV/Q7+JEv5YO2pd3JoET5ikj19pAIW3uMAO\nFstbvpkLC3PUcAPp9vW4BwARAQABiQEfBBgBCgAJBQJRwrKzAhsMAAoJEJ9PAhjd\nmdJ1L9kH/RoT/fCh/+3hqOzqIOMtwj5OR1c5mH86izQCDRAHOGr2l6dF+xMSX6Q7\nra9TytLb6e9Di5dmsp5X5d/9yPh+Abw7WtpAD9tcwov+LkfLUJZ0x17F0fNkxncD\nueTkzKzO9Vvdw5Djf92fXn/LuPmoy1GIF01Yn5cZjFBZzBF4AYOGMpdOH4qkLDJ3\nZDENXB3kESGdkkQQB1+k4hFMfai99diPhzENxMtelE1MP53I9GwSZ2QZeaZpdXje\neKybxmd8HQdDMV97eOZWjgIQaV6YW5FE+yzg1v5vttL79M8uh5CA8w7qVHMwE1UC\nGcCn2O4RufJhQUvsFJUdx3isWTN6xB0=\n=rG6v\n-----END PGP PUBLIC KEY BLOCK-----", "private": "-----BEGIN PGP PRIVATE KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\n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\nVHMwE1UCGcCn2O4RufJhQUvsFJUdx3isWTN6xB0=\n=MLgb\n-----END PGP PRIVATE KEY BLOCK-----"},
    "paddy": { "public": "-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\nmQGiBFHCuQQRBADrr5JPBU42Rbcz/bHl3QA4qUQ1eWJ3FWBg6pmItGYIDlCfiesi\noTYU4vjzZ1UEk//ZIjclWrkBeineP03lnLiVk4awKHjUNZwYawo/YjEZ/AVC2h9X\nWWaEIDpAQNRxTZrZvNX3WvX03jDNtUTJXhxBlC4JhYJCU0Dzmg5/4FSzXwCg7OhK\nsz6MqbsYt/VnWqGEehRDpuMEAJllwdAlOWbpP6QVkzy82fDQFgHJGkrd3+76omGs\ncN/ePKSdL2/oEbW7DsB2PKaw/C4nOPpAr8hTkrqCZv5OshJGTM1C5a2/LkNh+uAh\ne9o1Fd0eABc0UQ8hMVEj5HUNeZS05PWrPPsZz8pLaTHK/G0mxssGci8xLlSm01Wg\nTRT2A/0S+KZ3CQVsWLCm/At0QztfBiKc1bigTTneK8B6wajshkTNaxH6/Wtg+YiG\nwJ1Ik5ki5uJZRwZqXst0YEm/lfs7LmHdzoDjhvd5hDqHuxiBT3xvxckWSB3AG045\nNFHTI7zW9a5Ym/dRUciGNNg3fRVPGvNx9SYPbqUJRHiLBiDTxrQUUGFkZHkgPHBh\nZGR5QGdvLmNvbT6IYQQTEQoAIQUCUcK5BAIbAwULCQgHAwUVCgkICwUWAgMBAAIe\nAQIXgAAKCRCsjlWFY1m0f1rsAKDLHSoyb6787uSuSYzQm4GXMyslzQCeKHpvvtoV\n5r/JANCB3VkHjQbpwrG5AQ0EUcK5BBAEAKhzv6jBnGtpMk5OBUAKnMsRp/a8wvxd\nNT1NV3MjJVu1cF+F0+A+EPgEgynAVWnLhCZbt1ZmHll4qWFKOF+OfEJDn2FHfRSv\nsm8gK9PrYWs503jPKMVKhPbb5tlr3j1Kg2o2ngaVeiwXKNrIIvsOirgthGjBDjDl\nzONTag+EYzarAAMFA/9QBEOIjhLGSJydk9iBPmjeD6nkoE6giniR8n5hPh/2Nx7y\ng1bwxy17dvbqRIERxccpRnlt8BMHjCLGG9EwOsxAFFyoxHT1Ca+BMRX7cj0M+cA5\nRPdchGxiz8yLt/rByMoYOamjg+gUk7KUfBp7tHQZTohUwn2oK5HZuJSpkJQymYhJ\nBBgRCgAJBQJRwrkEAhsMAAoJEKyOVYVjWbR/FBcAnRvHCqCan0fa/6RhUK9V6HwJ\nLTk3AJ0Zew9ZimXbjlN8JEpCgwHYwBUXug==\n=V5cf\n-----END PGP PUBLIC KEY BLOCK-----", "private": "-----BEGIN PGP PRIVATE KEY BLOCK-----\nVersion: GnuPG/MacGPG2 v2.0.19 (Darwin)\nComment: GPGTools - http://gpgtools.org\n\nlQG7BFHCuQQRBADrr5JPBU42Rbcz/bHl3QA4qUQ1eWJ3FWBg6pmItGYIDlCfiesi\noTYU4vjzZ1UEk//ZIjclWrkBeineP03lnLiVk4awKHjUNZwYawo/YjEZ/AVC2h9X\nWWaEIDpAQNRxTZrZvNX3WvX03jDNtUTJXhxBlC4JhYJCU0Dzmg5/4FSzXwCg7OhK\nsz6MqbsYt/VnWqGEehRDpuMEAJllwdAlOWbpP6QVkzy82fDQFgHJGkrd3+76omGs\ncN/ePKSdL2/oEbW7DsB2PKaw/C4nOPpAr8hTkrqCZv5OshJGTM1C5a2/LkNh+uAh\ne9o1Fd0eABc0UQ8hMVEj5HUNeZS05PWrPPsZz8pLaTHK/G0mxssGci8xLlSm01Wg\nTRT2A/0S+KZ3CQVsWLCm/At0QztfBiKc1bigTTneK8B6wajshkTNaxH6/Wtg+YiG\nwJ1Ik5ki5uJZRwZqXst0YEm/lfs7LmHdzoDjhvd5hDqHuxiBT3xvxckWSB3AG045\nNFHTI7zW9a5Ym/dRUciGNNg3fRVPGvNx9SYPbqUJRHiLBiDTxgAAnjV7NcSjJs3o\njgw3U6Qziqv3Xom/CpK0FFBhZGR5IDxwYWRkeUBnby5jb20+iGEEExEKACEFAlHC\nuQQCGwMFCwkIBwMFFQoJCAsFFgIDAQACHgECF4AACgkQrI5VhWNZtH9a7ACgyx0q\nMm+u/O7krkmM0JuBlzMrJc0Anih6b77aFea/yQDQgd1ZB40G6cKxnQEyBFHCuQQQ\nBACoc7+owZxraTJOTgVACpzLEaf2vML8XTU9TVdzIyVbtXBfhdPgPhD4BIMpwFVp\ny4QmW7dWZh5ZeKlhSjhfjnxCQ59hR30Ur7JvICvT62FrOdN4zyjFSoT22+bZa949\nSoNqNp4GlXosFyjayCL7Doq4LYRowQ4w5czjU2oPhGM2qwADBQP/UARDiI4Sxkic\nnZPYgT5o3g+p5KBOoIp4kfJ+YT4f9jce8oNW8Mcte3b26kSBEcXHKUZ5bfATB4wi\nxhvRMDrMQBRcqMR09QmvgTEV+3I9DPnAOUT3XIRsYs/Mi7f6wcjKGDmpo4PoFJOy\nlHwae7R0GU6IVMJ9qCuR2biUqZCUMpkAAPkBMN8rslD+yR3FqMvzFJY1E0OXh6F5\nSC8ecR0x7B1gwQ8wiEkEGBEKAAkFAlHCuQQCGwwACgkQrI5VhWNZtH8UFwCgu9RW\n7gynGyLqgr5PKqiQFrF6t/kAoMSGoc3jYL0wCGIfx1OFFKZyVAdg\n=hEYc\n-----END PGP PRIVATE KEY BLOCK-----"}
  };
  
  var _escape = function(string) {
    return btoa(unescape(encodeURIComponent(string.toString())));
  };

  var _unescape = function(string) {
    return decodeURIComponent(escape(atob(string)));
  };

  var to_hex = function(string) {

  };

  var decodeKey = function(codedKey, p) {
    console.log(["Decoding",_unescape(codedKey)]);
    var msg = openpgp.read_message(_unescape(codedKey).toString())[0];
    console.log(['Found message', msg, msg.sessionKeys[0], p]);
    //console.log([msg.sessionKeys[0].publicKeyAlgorithmUsed, p.publicKey.MPIs, p.secMPIs, msg.sessionKeys[0].MPIs]);
    //console.log(['Decrypt', msg.sessionKeys[0].decrypt(msg,p.privateKeyPacket)]);
    var key = msg.decrypt({key: p, keymaterial: p.privateKeyPacket}, msg.sessionKeys[0]);
    console.log(['Found key', key]);
    return key;
  };

  var decodeString = function(string, passphrase) {
    return CryptoJS.AES.decrypt(unescape(string), passphrase).toString(CryptoJS.enc.Utf8);
  };

  var filter = function(text) {
    return text.search("en://") != -1;
  };

  var decodeNode = function(node) {
    console.log(['Decoding',node,node.nodeValue]);
    openpgp.init();
    var receiver = 'paddy';
    var key = openpgp.read_privateKey(keys[receiver].private)[0];
    //console.log(['Secure',key.decryptSecretMPIs('')]);
    //key.publicKey = openpgp.read_publicKey(keys[receiver].public)[0]; // Set public key on object..

    console.log(['Fingerprint',key.getFingerprint()]);
    var fingerprint = _escape(key.getFingerprint());
    console.log([key, fingerprint]);
    var regex = new RegExp("en\:\/\/([^ ]*)(?:\/[^ ]*)*/"+fingerprint+"-([^ ]+)","g");
    console.log(['Running regex',regex]);
    node.nodeValue = node.nodeValue.replace(regex,function(m,l,codedKey) {
      console.log('Decoding...');
      console.log(l);
      console.log(_unescape(codedKey));
      var passphrase = decodeKey(codedKey, key);
      var res = decodeString(l, passphrase);
      //console.log(res);
      //console.log('Decoded...');
      return res;
    });
  };

  var nativeTreeWalker = function(filter, decodeNode) {
    var walker = document.createTreeWalker(
        document.body, 
        NodeFilter.SHOW_TEXT, 
        null, 
        false
    );

    var node;
    var textNodes = [];

    while(node = walker.nextNode()) {
      if (filter(node.nodeValue)) { // Hopefully this will be quick to narrow out bad results
        decodeNode(node);
      }
    }
  };

  console.log('Walking Tree');
  nativeTreeWalker(filter, decodeNode);
  console.log('Finished Walking Tree');
})();